<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>회원가입페이지</title>
	<link th:href="@{/manage/assets/css/admin.css?v=1.1}" rel="stylesheet" type="text/css" />
</head>
<body>
<main>
            <header class="main-header style-2 navbar">
                <div class="col-brand">
                    <a href="#" class="brand-wrap">
                        <img src="https://velog.velcdn.com/images/mekite/post/3958812c-a50f-426c-a9ca-363b12b9bd4a/image.PNG" class="logo" />
                    </a>
                </div>
                <div class="col-nav">
                    <ul class="nav">
                        
                        <li class="nav-item">
                            <a class="nav-link btn-icon darkmode" href="#"> <i class="material-icons md-nights_stay"></i> </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="requestfullscreen nav-link btn-icon"><i class="material-icons md-cast"></i></a>
                        </li>
                        
                        
                    </ul>
                </div>
            </header>
            <section class="content-main mt-80 mb-80">
                <div class="card mx-auto card-login">
                    <div class="card-body">
                        <h4 class="card-title mb-4">회원가입</h4>
                        <form id="registerForm" th:action="@{/register}" method="post">
                            <div class="mb-3">
                                <label class="form-label">아이디</label>
                                <input id="mbrId" name="mbrId" class="form-control w-100" placeholder="아이디를 입력해주세요" type="text" />
                                <p id="checkId" style="color:red;">아이디를 입력해주세요.</p>
                            </div>
                            <!-- form-group// -->
                            <div class="mb-3">
                                <label class="form-label">전화번호</label>
                                <div class="row gx-2">                                    
                                    <input id="mbrPhoneNum" name="mbrPhoneNum" class="form-control w-100" placeholder="전화번호를 입력해주세요" type="text" disabled="disabled"/>
                                </div>
                            </div>
                            <!-- form-group// -->
                            <div class="mb-3">
                                <label class="form-label">비밀번호</label>
                                <input id="mbrPw" name="mbrPw" class="form-control w-100" placeholder="비밀번호를 입력해주세요" type="password" disabled="disabled"/>
                            </div>
                            <!-- form-group// -->
                            <div class="mb-3">
                                <label class="form-label">이름</label>
                                <input id="mbrName" name="mbrName" class="form-control w-100" placeholder="이름을 입력해주세요" type="text" disabled="disabled"/>
                            </div>
                            <!-- form-group// -->
                            <div class="mb-3">
                                <label class="form-label">이메일</label>
                                <input id="mbrEmail" name="mbrEmail" class="form-control w-100" placeholder="이메일을 입력해주세요" type="text" disabled="disabled"/>
                            </div>
                            <!-- form-group// -->
                            <div class="mb-3">
                                <label class="form-label">생년월일</label>
                                <input id="mbrBirthDate" name="mbrBirthDate" class="form-control w-100" placeholder="생년월일을 입력해주세요" type="date" disabled="disabled"/>
                            </div>
                            <!-- form-group// -->
                            <div class="mb-3">
                                <label class="form-label">성별</label>
                                <select class="form-control w-100" id="mbrGender" name="mbrGender" disabled="disabled">
                                    <option value="남">남자</option>
                                    <option value="여">여자</option>
                                </select>

                            </div>
                            <!-- form-group// -->
                            <div class="mb-3">
                                <p class="small text-center text-muted text-wrap">가입함으로써 귀하는 당사의 사용자 공지 및 개인정보 보호정책을 읽고 동의했음을 확인하게 됩니다.</p>
                            </div>
                            <!-- form-group  .// -->
                            <div class="mb-4">
                                <button type="submit" id="registerBtn" class="btn btn-primary w-100" disabled="disabled">회원가입</button>
                            </div>
                            <!-- form-group// -->
                        </form>                       
                        
                        <p class="text-center mb-2">계정이 있으신가요? <a th:href="@{/login}">로그인하기</a></p>
                    </div>
                </div>
            </section>
            <footer class="main-footer text-center">
                <p class="font-xs">
                    <script>
                        document.write(new Date().getFullYear());
                    </script>
                    &copy; DoSelf, Inc.
                </p>
                <p class="font-xs mb-30">All rights reserved</p>
            </footer>
        </main>
</body>
	<!--/* 사용자 추가 js file */-->
	<th:block layout:fragment="customJsResource">
		<script th:src="@{/manage/assets/js/vendors/jquery-3.6.0.min.js}"></script>
		<script th:src="@{/manage/assets/js/vendors/bootstrap.bundle.min.js}"></script>
		<script th:src="@{/manage/assets/js/vendors/jquery.fullscreen.min.js}"></script>
		<script th:src="@{/manage/assets/js/main.js?v=1.1}" type="text/javascript"></script>
	</th:block>
        
    <!--/* 사용자 추가 js script */-->
    <th:block layout:fragment="customJs">
    	<script th:inline="javascript">
    		const msg = /*[[${msg}]]*/ "msg";
    		if(msg) alert(msg);
    		//const message = /*[[${message}]]*/ "message";
    		//if(message) alert(message);
    		
    		$('#mbrId').on('change',function(){
	    		const checkMbrId = $('#mbrId').val();
	    		
	    		if(checkMbrId == ''){
    				$('#checkId').text('아이디를 입력해주세요.')
					 .css({'color': 'red'});
    				
    				$('#registerForm').find('input, select')
					  .not('#mbrId')
					  .prop('disabled',true);
    				
    				return;
    			}
	    		//ajax 요청
	    		const request = $.ajax({
	    			url : '/register/idCheck',
	    			method : 'POST',
	    			data : {'mbrId' : checkMbrId},
	    			dataType : 'json'
	    		});
	    		
	    		request.done(function(data){
	    			const isDuplicate = data;
	    			
	    			$('#registerForm').find('input, select')
	    							  .not('#mbrId')
	    							  .prop('disabled',isDuplicate);
	    			
	    			if(isDuplicate){
	    				$('#checkId').text('이미 사용중인 아이디 입니다.')
	    							 .css({'color': 'red'});
	    			}
	    			else{
	    				$('#checkId').text('사용가능한 아이디 입니다.')
	    							 .css({'color': 'skyblue'});	    				
	    			}
	    		});
	    		
	    		request.fail(function(jQXHR, textStatus, error){
    				console.log(error);
    			});	
	    		
	    		
    		});    			    	
    		
    		$(document).ready(function () {               
                $('#registerForm input').on('input', function () {
                    
                	let isAllFilled = true;
                    $('#registerForm input[type="text"]').each(function () {
                        if ($(this).val().trim() === '') {
                            isAllFilled = false;
                        }
                    });
                    $('#registerBtn').prop('disabled', !isAllFilled);
                });
      
                $('#registerBtn').click(function (e) {
                    e.preventDefault();
                    let isSubmit = true;
       
                    $('#registerForm input[type="text"]').each(function () {

                    	if ($(this).val().trim() === '') {
                    		isSubmit = false;
                    		$(this).focus();
	                        return false;
                    	}                  
	                });
                    if (isSubmit) {
                    	$('#registerForm').submit();
                    }
                });
            });
    		
    	</script>
    </th:block>
</html>